# 自動スケジュール同期プログラム

このプログラムは、アップルスクリプトを実行してCSVファイルがダウンロードされたら自動的にGoogleカレンダーに同期します。

## 機能

1. **アップルスクリプト実行**: 指定されたアップルスクリプトを実行
2. **CSVファイル監視**: ダウンロードフォルダで`scheduleList-*.csv`ファイルの出現を監視
3. **Googleカレンダー同期**: CSVファイルの内容をGoogleカレンダーに自動同期
4. **重複チェック**: 既存のイベントとの重複を自動検出・スキップ
5. **ログ機能**: 詳細なログをファイルとコンソールに出力

## 使用方法

### 1回だけ実行
```bash
python auto_schedule_sync.py --once
```

### 継続実行（1時間間隔）
```bash
python auto_schedule_sync.py --interval 3600
```

### 継続実行（30分間隔）
```bash
python auto_schedule_sync.py --interval 1800
```

### デフォルト（1回だけ実行）
```bash
python auto_schedule_sync.py
```

## 設定

### アップルスクリプトのパス
プログラム内で以下のパスが設定されています：
```python
self.applescript_path = "/Users/ueshima/Library/CloudStorage/OneDrive-医療法人社団　慶友会　吉田病院/00_Automate/groupsession_schedule_to_google.scpt"
```

### ダウンロードフォルダ
デフォルトで`~/Downloads`が設定されています。

## ログファイル

- `auto_schedule_sync.log`: 詳細なログが記録されます
- コンソールにもリアルタイムでログが表示されます

## エラーハンドリング

- アップルスクリプトのタイムアウト（60秒）
- CSVファイルのダウンロード待機タイムアウト（5分）
- ファイル処理エラーの自動リトライ
- 予期しないエラー時の30秒待機後リトライ

## 注意事項

1. **Googleカレンダー認証**: 初回実行時にGoogleカレンダーへの認証が必要です
2. **アップルスクリプト**: 指定されたパスにアップルスクリプトが存在することを確認してください
3. **ネットワーク接続**: インターネット接続が必要です
4. **権限**: ダウンロードフォルダへのアクセス権限が必要です

## トラブルシューティング

### アップルスクリプトが実行できない場合
- パスが正しいか確認
- アップルスクリプトファイルが存在するか確認
- 実行権限があるか確認

### CSVファイルが見つからない場合
- ダウンロードフォルダのパスを確認
- ファイル名が`scheduleList-*.csv`の形式か確認
- アップルスクリプトが正常に実行されているか確認

### Googleカレンダー同期が失敗する場合
- 認証情報（`client_id.json`）が正しく設定されているか確認
- 環境変数`GOOGLE_CALENDAR_ID`が設定されているか確認
- インターネット接続を確認 